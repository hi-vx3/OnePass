datasource db {
     provider = "mysql"
     url      = env("DATABASE_URL")
   }

   generator client {
     provider = "prisma-client-js"
   }

   model User {
     id                  Int            @id @default(autoincrement())
     publicId            BigInt         @unique @map("public_id")
     email               String         @unique     
     pendingEmail        String?        @unique @map("pending_email")
     verificationToken   String?
     verificationTokenExpiresAt DateTime? @map("verification_token_expires_at")
     name                String?
     isVerified          Boolean        @default(false)
     createdAt           DateTime       @default(now())
     totpSecret          String? // Secret for TOTP generation
     totpCode            String? // Temporary TOTP code
     totpExpiresAt       DateTime? // Expiry time for TOTP code
     totpLoginAttempts   Int            @default(0) // Failed TOTP login attempts
     totpBlockedUntil    DateTime? // Timestamp until which the user is blocked from TOTP login
     virtualEmail        VirtualEmail?
     apiKeys             ApiKey[]
     subscriptionTier    String         @default("FREE") // e.g., FREE, PRO, BUSINESS
     linkedSites         LinkedSite[]
     notifications       Notification[]
     activities          Activity[]
     forwardedEmailLogs  ForwardedEmailLog[]
     recoveryCodes       RecoveryCode[]
     notificationsEnabled Boolean        @default(true)
     avatarUrl           String?
     isDeveloper         Boolean        @default(false) @map("is_developer")
   }

   model VirtualEmail {
     id        Int      @id @default(autoincrement())
     address   String   @unique
     isActive  Boolean  @default(true)
     isForwardingActive Boolean  @default(true)
     user      User     @relation(fields: [userId], references: [id])
     userId    Int      @unique
     createdAt DateTime @default(now())
     canChange Boolean  @default(true)
   }



   model ApiKey {
     id           String   @id @default(uuid())
     name         String
     clientId     String   @unique @map("client_id")
     clientSecret String   @map("client_secret")
     hashedSecret String   @map("hashed_secret")
     redirectUris String   @db.Text @map("redirect_uris")
     scopes       String   @db.Text @default("")
     logoUrl      String?  @map("logo_url")
     user         User     @relation(fields: [userId], references: [id])
     userId       Int      @map("user_id")
     createdAt    DateTime @default(now())
     requestCount Int      @default(0) @map("request_count")
     lastUsedAt   DateTime? @map("last_used_at")
     linkedSites  LinkedSite[]
   }

   model LinkedSite {
     id           Int      @id @default(autoincrement())
     name         String
     url          String
     email        String
     lastActivity DateTime @default(now())
     apiKey       ApiKey   @relation(fields: [clientId], references: [clientId])
     clientId     String   @map("client_id")
     user         User     @relation(fields: [userId], references: [id])
     userId       Int

     @@unique([userId, clientId], name: "userId_clientId")
   }

   model Notification {
     id        Int      @id @default(autoincrement())
     type      String // 'security', 'message', 'warning', 'success'
     title     String
     message   String
     isRead    Boolean  @default(false)
     user      User     @relation(fields: [userId], references: [id])
     userId    Int
     createdAt DateTime @default(now())
   }

   model Activity {
     id          Int      @id @default(autoincrement())
     type        String // 'login', 'message', 'create', 'update'
     title       String
     description String
     user        User     @relation(fields: [userId], references: [id])
     ipAddress   String?  @map("ip_address")
     userAgent   String?  @db.Text @map("user_agent")
     userId      Int
     createdAt   DateTime @default(now())
   }

   model AuthorizationCode {
     id          Int      @id @default(autoincrement())
     code        String   @unique
     expiresAt   DateTime @map("expires_at")
     redirectUri String   @map("redirect_uri")
     scope       String
     clientId    String   @map("client_id")
     userId      Int      @map("user_id")
   codeChallenge       String?  @map("code_challenge")
   codeChallengeMethod String?  @map("code_challenge_method")
     createdAt   DateTime @default(now())
   }

   model ForwardedEmailLog {
     id                  Int      @id @default(autoincrement())
     virtualEmailAddress String
     senderAddress       String
     subject             String
     forwardedAt         DateTime @default(now())
     user                User     @relation(fields: [userId], references: [id])
     userId              Int
   }

   model RecoveryCode {
     id         Int      @id @default(autoincrement())
     user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
     userId     Int      @map("user_id")
     hashedCode String   @unique @map("hashed_code")
     isUsed     Boolean  @default(false) @map("is_used")
     createdAt  DateTime @default(now()) @map("created_at")

     @@index([userId])
   }