<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | OnePass</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #2563EB;
            --color-error: #EF4444;
            --color-bg: #F9FAFB;
            --color-card: #FFFFFF;
            --color-border: #D1D5DB;
            --font-main: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--color-bg);
        }

        .brand-gradient {
            background: linear-gradient(135deg, var(--color-primary) 0%, #8b5cf6 100%);
        }

        .login-container {
            background: linear-gradient(rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.95)),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%23f8fafc"/><path d="M0 0L100 100" stroke="%23e2e8f0" stroke-width="1"/><path d="M100 0L0 100" stroke="%23e2e8f0" stroke-width="1"/></svg>');
            background-size: 300px;
        }

        .code-input {
            transition: all 0.3s ease;
        }

        .code-input:focus {
            transform: scale(1.05);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.3);
        }

        .progress-bar {
            animation: progress 60s linear forwards;
        }

        @keyframes progress {
            from {
                width: 100%;
            }

            to {
                width: 0%;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* BEM Naming Convention */
        .login-form__input {
            appearance: none;
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .login-form__input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .login-form__button {
            position: relative;
            width: 100%;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            color: white;
            background-color: var(--color-primary);
            transition: all 0.2s;
        }

        .login-form__button:hover {
            opacity: 0.9;
        }

        .login-form__button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.3);
        }

        .login-form__button--loading {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .login-form__error {
            padding: 0.75rem;
            margin-top: 1rem;
            border-radius: 0.375rem;
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--color-error);
            font-size: 0.875rem;
        }

        .login-form__success {
            padding: 0.75rem;
            margin-top: 1rem;
            border-radius: 0.375rem;
            background-color: rgba(16, 185, 129, 0.1);
            color: #10B981;
            font-size: 0.875rem;
        }
    </style>
</head>

<body class="min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i data-feather="shield" class="text-indigo-600 w-8 h-8"></i>
                        <span class="ml-2 text-xl font-bold text-gray-900">OnePass</span>
                    </div>
                </div>
                <div class="hidden md:ml-6 md:flex md:items-center md:space-x-4">
                    <a href="index.html"
                        class="px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-900">الرئيسية</a>
                    <a href="#" class="px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-900">كيف تعمل</a>
                    <a href="#" class="px-3 py-2 text-sm font-medium text-gray-500 hover:text-gray-900">المطورون</a>
                </div>
                <div class="flex items-center">
                    <a href="register.html"
                        class="px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white brand-gradient hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        إنشاء حساب
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 login-container">
        <div class="max-w-md w-full space-y-8 bg-white p-10 rounded-xl shadow-xl">
            <!-- Step 1: Email Entry -->
            <div id="step1" class="fade-in">
                <div class="flex justify-center">
                    <i data-feather="shield" class="text-indigo-600 w-12 h-12"></i>
                </div>
                <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">
                    تسجيل الدخول إلى حسابك
                </h2>
                <p class="mt-2 text-center text-sm text-gray-600">
                    أو <a href="register.html" class="font-medium text-indigo-600 hover:text-indigo-500">إنشاء حساب
                        جديد</a>
                </p>

                <form class="mt-8 space-y-6" id="emailForm">
                    <div class="rounded-md shadow-sm -space-y-px">
                        <div>
                            <label for="email-address" class="block text-sm font-medium text-gray-700 mb-1">البريد
                                الإلكتروني</label>
                            <input id="email-address" name="email" type="email" autocomplete="email" required
                                class="login-form__input" placeholder="example@OnePass.com">
                        </div>
                    </div>

                    <div>
                        <button type="submit" id="sendTOTPButton" class="login-form__button">
                            <span class="absolute right-0 inset-y-0 flex items-center pr-3">
                                <i data-feather="arrow-left"
                                    class="h-5 w-5 text-indigo-300 group-hover:text-indigo-200"></i>
                            </span>
                            إرسال رمز التحقق
                        </button>
                    </div>

                    <div id="emailError" class="login-form__error hidden"></div>
                </form>

                <div class="relative mt-6">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-300"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white text-gray-500">
                            أو الدخول عبر
                        </span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-3 mt-4">
                    <div>
                        <a href="#"
                            class="w-full inline-flex justify-center py-2.5 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors">
                            <i data-feather="github" class="h-5 w-5"></i>
                        </a>
                    </div>
                    <div>
                        <a href="#"
                            class="w-full inline-flex justify-center py-2.5 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors">
                            <i data-feather="google" class="h-5 w-5"></i>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Step 2: TOTP Verification -->
            <div id="step2" class="hidden fade-in">
                <div class="flex justify-center">
                    <i data-feather="key" class="text-indigo-600 w-12 h-12"></i>
                </div>
                <h2 class="mt-6 text-center text-2xl font-extrabold text-gray-900">
                    التحقق بخطوتين
                </h2>
                <p class="mt-2 text-center text-sm text-gray-600">
                    تم إرسال رمز التحقق المكون من 6 أرقام إلى
                    <span id="userEmail" class="font-medium text-indigo-600">user@example.com</span>
                </p>

                <form class="mt-6 space-y-6" id="totpForm">
                    <div class="flex justify-between space-x-2">
                        <input type="text" maxlength="1"
                            class="code-input w-12 h-12 text-center text-xl border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            onkeyup="moveToNext(this)">
                        <input type="text" maxlength="1"
                            class="code-input w-12 h-12 text-center text-xl border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            onkeyup="moveToNext(this)">
                        <input type="text" maxlength="1"
                            class="code-input w-12 h-12 text-center text-xl border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            onkeyup="moveToNext(this)">
                        <input type="text" maxlength="1"
                            class="code-input w-12 h-12 text-center text-xl border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            onkeyup="moveToNext(this)">
                        <input type="text" maxlength="1"
                            class="code-input w-12 h-12 text-center text-xl border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            onkeyup="moveToNext(this)">
                        <input type="text" maxlength="1"
                            class="code-input w-12 h-12 text-center text-xl border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                            onkeyup="moveToNext(this)">
                    </div>

                    <div class="text-center text-sm text-gray-500 mt-4">
                        <div class="h-1 w-full bg-gray-200 rounded-full mb-1">
                            <div class="progress-bar h-1 bg-indigo-600 rounded-full"></div>
                        </div>
                        <p>ينتهي الرمز خلال <span id="countdown">01:30</span></p>
                    </div>

                    <div>
                        <button type="submit" id="verifyTOTPButton" class="login-form__button">
                            <span class="absolute right-0 inset-y-0 flex items-center pr-3">
                                <i data-feather="check" class="h-5 w-5 text-indigo-300 group-hover:text-indigo-200"></i>
                            </span>
                            تأكيد الرمز
                        </button>
                    </div>

                    <div id="totpError" class="login-form__error hidden"></div>
                    <div id="totpSuccess" class="login-form__success hidden"></div>
                </form>

                <div class="text-center mt-4">
                    <button id="resendCode"
                        class="text-sm text-indigo-600 hover:text-indigo-500 disabled:text-gray-400 transition-colors"
                        disabled>
                        إعادة إرسال الرمز (60)
                    </button>
                </div>

                <div class="text-center mt-4">
                    <button id="backToEmail" class="text-sm text-gray-600 hover:text-gray-900 transition-colors">
                        <i data-feather="arrow-right" class="h-4 w-4 inline ml-1"></i>
                        العودة لإدخال البريد الإلكتروني
                    </button>
                </div>
            </div>

            <!-- Step 3: Success -->
            <div id="step3" class="hidden fade-in">
                <div class="flex justify-center">
                    <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center">
                        <i data-feather="check" class="text-green-600 w-8 h-8"></i>
                    </div>
                </div>
                <h2 class="mt-6 text-center text-2xl font-extrabold text-gray-900">
                    تم تسجيل الدخول بنجاح!
                </h2>
                <p class="mt-2 text-center text-sm text-gray-600">
                    يتم توجيهك إلى لوحة التحكم...
                </p>

                <div class="mt-6">
                    <div class="h-1.5 w-full bg-gray-200 rounded-full">
                        <div class="h-1.5 bg-indigo-600 rounded-full animate-pulse"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-12">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p class="text-sm text-gray-500 mb-4 md:mb-0">
                    © 2025  OnePass. جميع الحقوق محفوظة.
                </p>
                <div class="flex space-x-6">
                    <a href="#" class="text-sm text-gray-500 hover:text-gray-900">سياسة الخصوصية</a>
                    <a href="#" class="text-sm text-gray-500 hover:text-gray-900">الشروط والأحكام</a>
                    <a href="#" class="text-sm text-gray-500 hover:text-gray-900">اتصل بنا</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        feather.replace();

        // قاموس ترجمة رسائل الخادم إلى العربية
        const translations = {
            // رسائل /api/auth/request-totp
            "TOTP code sent successfully": "تم إرسال رمز التحقق بنجاح",
            "Email not registered": "البريد الإلكتروني غير مسجل",
            "Too many requests. Please wait 15 minutes before trying again.": "تم إرسال طلبات كثيرة جدًا، يرجى الانتظار 15 دقيقة قبل المحاولة مرة أخرى",
            "Server error during TOTP request": "حدث خطأ في الخادم أثناء طلب رمز التحقق",

            // رسائل /api/auth/verify-totp
            "TOTP code verified successfully": "تم التحقق من رمز التحقق بنجاح",
            "No valid TOTP code found": "لم يتم العثور على رمز تحقق صالح",
            "TOTP code expired": "رمز التحقق منتهي الصلاحية",
            "Invalid TOTP code": "رمز التحقق غير صحيح",
            "Too many verification attempts. Please wait 15 minutes.": "محاولات تحقق كثيرة جدًا، يرجى الانتظار 15 دقيقة",
            "Server error during TOTP verification": "حدث خطأ في الخادم أثناء التحقق من رمز التحقق"
        };

        // متغيرات حالة النظام
        let resendTimer = 90;
        let countdownTimer = 90;
        let resendInterval;
        let countdownInterval;
        let currentEmail = '';

        // عناصر DOM
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const step3 = document.getElementById('step3');
        const emailForm = document.getElementById('emailForm');
        const totpForm = document.getElementById('totpForm');
        const userEmail = document.getElementById('userEmail');
        const resendButton = document.getElementById('resendCode');
        const backToEmail = document.getElementById('backToEmail');
        const countdownElement = document.getElementById('countdown');
        const emailInput = document.getElementById('email-address');
        const sendTOTPButton = document.getElementById('sendTOTPButton');
        const verifyTOTPButton = document.getElementById('verifyTOTPButton');
        const emailError = document.getElementById('emailError');
        const totpError = document.getElementById('totpError');
        const totpSuccess = document.getElementById('totpSuccess');

        // إعادة تهيئة الحالة عند تحميل الصفحة (لمنع حفظ البيانات)
        document.addEventListener('DOMContentLoaded', function () {
            // إعادة تعيين المتغيرات
            currentEmail = '';
            resendTimer = 90;
            countdownTimer = 90;
            clearInterval(resendInterval);
            clearInterval(countdownInterval);

            // مسح حقول الإدخال
            emailInput.value = '';
            const codeInputs = document.querySelectorAll('.code-input');
            codeInputs.forEach(input => {
                input.value = '';
                input.setAttribute('dir', 'ltr'); // جعل الإدخال من اليسار إلى اليمين
            });

            // إعادة عرض الخطوة الأولى وإخفاء الآخرين
            step1.classList.remove('hidden');
            step2.classList.add('hidden');
            step3.classList.add('hidden');

            // إعادة تعيين زر إعادة الإرسال
            resendButton.disabled = false;
            resendButton.textContent = 'إعادة إرسال الرمز';

            // إعادة تهيئة الأخطاء والنجاح
            hideError(emailError);
            hideError(totpError);
            hideError(totpSuccess);
        });

        // الانتقال إلى الحقل التالي عند إدخال رقم
        async function moveToNext(input) {
            if (input.value.length === input.maxLength) {
                const next = input.nextElementSibling;
                if (next) next.focus();
            } else if (input.value.length === 0) {
                const prev = input.previousElementSibling;
                if (prev) prev.focus();
            }

            const inputs = document.querySelectorAll('.code-input');
            const allFilled = Array.from(inputs).every(input => input.value.length === 1);
            if (allFilled) {
                await handleTotpFormSubmit(new Event('submit', { cancelable: true }));
            }
        }

        // معالجة رسالة Cooldown
        function handleCooldownMessage(message) {
            if (message.includes('Please wait') && message.includes('seconds')) {
                const secondsMatch = message.match(/\d+/);
                if (secondsMatch) {
                    return `يرجى الانتظار ${secondsMatch[0]} ثانية قبل طلب رمز جديد`;
                }
            }
            return translations[message] || message || 'حدث خطأ أثناء إرسال رمز التحقق';
        }

        // معالجة إرسال البريد الإلكتروني
        emailForm.addEventListener('submit', async function (e) {
            e.preventDefault();

            const email = emailInput.value.trim();

            // التحقق من صحة البريد الإلكتروني
            if (!isValidEmail(email)) {
                showError(emailError, 'يرجى إدخال بريد إلكتروني صحيح');
                return;
            }

            // إخفاء أي أخطاء سابقة
            hideError(emailError);

            // تعطيل الزر وعرض حالة التحميل
            setLoadingState(sendTOTPButton, true);

            try {
                // الاتصال بـ API لإرسال رمز TOTP
                const response = await fetch('http://localhost:3000/api/auth/request-totp', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email })
                });

                let data;
                try {
                    data = await response.json();
                } catch (jsonError) {
                    throw new Error('استجابة الخادم غير صالحة');
                }

                if (response.ok) {
                    // عرض رسالة النجاح المترجمة
                    showSuccess(emailError, translations[data.message] || data.message || 'تم إرسال رمز التحقق بنجاح');

                    // حفظ البريد الإلكتروني للاستخدام لاحقاً
                    currentEmail = email;

                    // عرض الخطوة الثانية وتحديث البريد المعروض
                    userEmail.textContent = email;
                    step1.classList.add('hidden');
                    step2.classList.remove('hidden');

                    // بدء عدادات التوقيت
                    startResendTimer();
                    startCountdown();
                } else {
                    // معالجة رسالة Cooldown أو أي رسالة خطأ أخرى
                    showError(emailError, handleCooldownMessage(data.message));
                }
            } catch (error) {
                showError(emailError, error.message || 'حدث خطأ في الاتصال بالخادم');
            } finally {
                setLoadingState(sendTOTPButton, false);
            }
        });

        // معالجة إرسال رمز التحقق
        totpForm.addEventListener('submit', async function (e) {
            e.preventDefault();

            // جمع رمز التحقق من الحقول الستة
            const inputs = document.querySelectorAll('.code-input');
            const code = Array.from(inputs).map(input => input.value).join('');

            // التحقق من أن الرمز مكون من 6 أرقام
            if (code.length !== 6 || !/^\d+$/.test(code)) {
                showError(totpError, 'يرجى إدخال رمز التحقق المكون من 6 أرقام');
                return;
            }

            // إخفاء أي أخطاء سابقة
            hideError(totpError);

            // تعطيل الزر وعرض حالة التحميل
            setLoadingState(verifyTOTPButton, true);

            try {
                // الاتصال بـ API للتحقق من رمز TOTP
                const response = await fetch('http://localhost:3000/api/auth/verify-totp', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: currentEmail,
                        code: code
                    })
                });

                let data;
                try {
                    data = await response.json();
                } catch (jsonError) {
                    throw new Error('استجابة الخادم غير صالحة');
                }

                if (response.ok) {
                    // إيقاف العدادات
                    clearInterval(resendInterval);
                    clearInterval(countdownInterval);

                    // عرض رسالة النجاح المترجمة
                    showSuccess(totpSuccess, translations[data.message] || data.message || 'تم التحقق من رمز التحقق بنجاح');

                    // الانتقال إلى شاشة النجاح بعد تأخير قصير
                    setTimeout(() => {
                        step2.classList.add('hidden');
                        step3.classList.remove('hidden');

                        // توجيه المستخدم بعد تأخير إضافي
                        setTimeout(() => {
                            window.location.href = '/dashboard';
                        }, 2000);
                    }, 1500);
                } else {
                    // عرض رسالة الخطأ المترجمة
                    showError(totpError, translations[data.message] || data.message || 'رمز التحقق غير صحيح أو منتهي الصلاحية');
                }
            } catch (error) {
                showError(totpError, error.message || 'حدث خطأ في الاتصال بالخادم');
            } finally {
                setLoadingState(verifyTOTPButton, false);
            }
        });

        // العودة إلى إدخال البريد الإلكتروني
        backToEmail.addEventListener('click', function () {
            // إيقاف العدادات
            clearInterval(resendInterval);
            clearInterval(countdownInterval);

            // إعادة تعيين الزر
            resendButton.disabled = false;
            resendButton.textContent = 'إعادة إرسال الرمز';

            // الانتقال إلى الخطوة الأولى
            step2.classList.add('hidden');
            step1.classList.remove('hidden');
        });

        // بدء عداد إعادة الإرسال
        function startResendTimer() {
            resendButton.disabled = true;
            resendTimer = 90;
            updateResendButton();

            resendInterval = setInterval(() => {
                resendTimer--;
                updateResendButton();

                if (resendTimer <= 0) {
                    clearInterval(resendInterval);
                    resendButton.disabled = false;
                    resendButton.textContent = 'إعادة إرسال الرمز';
                }
            }, 1000);
        }

        // تحديث زر إعادة الإرسال
        function updateResendButton() {
            resendButton.textContent = `إعادة إرسال الرمز (${resendTimer})`;
        }

        // بدء عداد الوقت المتبقي للرمز
        function startCountdown() {
            countdownTimer = 90;
            updateCountdown();

            countdownInterval = setInterval(() => {
                countdownTimer--;
                updateCountdown();

                if (countdownTimer <= 0) {
                    clearInterval(countdownInterval);
                    // يمكن هنا إضافة منطق لجعل الرمز منتهي الصلاحية
                }
            }, 1000);
        }

        // تحديث عرض الوقت المتبقي
        function updateCountdown() {
            const minutes = Math.floor(countdownTimer / 60);
            const seconds = countdownTimer % 60;
            countdownElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // معالجة النقر على إعادة الإرسال
        resendButton.addEventListener('click', async function () {
            if (!resendButton.disabled) {
                try {
                    // الاتصال بـ API لإعادة إرسال رمز TOTP
                    const response = await fetch('http://localhost:3000/api/auth/request-totp', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ email: currentEmail })
                    });

                    let data;
                    try {
                        data = await response.json();
                    } catch (jsonError) {
                        throw new Error('استجابة الخادم غير صالحة');
                    }

                    if (response.ok) {
                        // عرض رسالة النجاح المترجمة
                        showSuccess(totpSuccess, translations[data.message] || data.message || 'تم إعادة إرسال رمز التحقق بنجاح');
                        startResendTimer();
                        startCountdown();
                    } else {
                        // معالجة رسالة Cooldown أو أي رسالة خطأ أخرى
                        showError(totpError, handleCooldownMessage(data.message));
                    }
                } catch (error) {
                    showError(totpError, error.message || 'حدث خطأ في الاتصال بالخادم');
                }
            }
        });

        // وظائف مساعدة
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function showError(element, message) {
            element.textContent = message;
            element.classList.remove('hidden');
        }

        function hideError(element) {
            element.classList.add('hidden');
        }

        function showSuccess(element, message) {
            element.textContent = message;
            element.classList.remove('hidden');

            // إخفاء الرسالة بعد 3 ثوان
            setTimeout(() => {
                element.classList.add('hidden');
            }, 3000);
        }

        function setLoadingState(button, isLoading) {
            if (isLoading) {
                button.disabled = true;
                button.classList.add('login-form__button--loading');
                button.innerHTML = `
            <span class="absolute right-0 inset-y-0 flex items-center pr-3">
                <i data-feather="loader" class="h-5 w-5 animate-spin"></i>
            </span>
            جاري المعالجة...
        `;
                feather.replace();
            } else {
                button.disabled = false;
                button.classList.remove('login-form__button--loading');

                if (button.id === 'sendTOTPButton') {
                    button.innerHTML = `
                <span class="absolute right-0 inset-y-0 flex items-center pr-3">
                    <i data-feather="arrow-left" class="h-5 w-5 text-indigo-300 group-hover:text-indigo-200"></i>
                </span>
                إرسال رمز التحقق
            `;
                } else {
                    button.innerHTML = `
                <span class="absolute right-0 inset-y-0 flex items-center pr-3">
                    <i data-feather="check" class="h-5 w-5 text-indigo-300 group-hover:text-indigo-200"></i>
                </span>
                تأكيد الرمز
            `;
                }
                feather.replace();
            }
        }

    </script>
</body>

</html>